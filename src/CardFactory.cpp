//-----------------------------------------------------------------------------
// CardFactory.cpp
//-----------------------------------------------------------------------------
//-----------------------------------------------------------------------------
// include files
//-----------------------------------------------------------------------------
#include "dominion/CardFactory.h"
//-----------------------------------------------------------------------------
// class methods
//-----------------------------------------------------------------------------
namespace dominion {
    static CardFactory *sgInstance = NULL;
    //-----------------------------------------------------------------------------
    // インスタンスの作成
    //-----------------------------------------------------------------------------
    void CardFactory::createInstance(void) {
        if(sgInstance == NULL) {
            sgInstance = new CardFactory();
        }
    }
    //-----------------------------------------------------------------------------
    // インスタンスの削除
    //-----------------------------------------------------------------------------
    void CardFactory::deleteInstance(void) {
        if(sgInstance != NULL) {
            delete sgInstance;
            sgInstance = NULL;
        }
    }
    //-----------------------------------------------------------------------------
    // インスタンスの取得
    //-----------------------------------------------------------------------------
    CardFactory *CardFactory::getInstance(void) {
        return sgInstance;
    }
    //-----------------------------------------------------------------------------
    // コンストラクタ
    //-----------------------------------------------------------------------------
    CardFactory::CardFactory() {}
    //-----------------------------------------------------------------------------
    // デストラクタ
    //-----------------------------------------------------------------------------
    CardFactory::~CardFactory() {}
    //-----------------------------------------------------------------------------
    // カードの作成
    //-----------------------------------------------------------------------------
    Card *CardFactory::createCard(const char *cardEffectName) {
        std::map <std::string, CardEffect *>::iterator it = mEffects.find(cardEffectName);
        if(it == mEffects.end()) {
            return NULL;
        }
        // このカード効果を参照するカードを作成
        Card *card = new Card(it->second);
        return card;
    }
    //-----------------------------------------------------------------------------
    // カード効果の追加
    //-----------------------------------------------------------------------------
    void CardFactory::addCardEffect(CardEffect *cardEffect) {
        if(cardEffect == NULL) return;
        mEffects.insert(std::make_pair(cardEffect->getName(), cardEffect));
    }
    
}
//-----------------------------------------------------------------------------
// End Of File
//-----------------------------------------------------------------------------
